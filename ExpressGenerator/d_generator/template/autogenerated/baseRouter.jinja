// Autogenerated from {{model_filename}} file
// Created at {{timestamp|strftime}}

var express = require('express')
var services = require('../../services')


var router = express.Router()

// Get all entities
router.get('/', async function (req, res, next) {
    let {{entity.name|lower}}Entities = await services.{{entity.name|lower}}_service.getAll(req.query).catch(next);
    res.status(200).json({{entity.name|lower}}Entities);
});

// Exists by id (request.params.id)
router.get('/exists/:id', async function (req, res, next) {
    let exists = await services.{{entity.name|lower}}_service.exists(req.params.id).catch(next);

    if (!exists){
        next(new Error('{{entity.name}} with id ' + req.params.id + ' doesn\'t exist'));
        return
    }

    res.status(200).json({ exists });
});

// Get entity count
router.get('/count', async function (req, res, next) {
    let count = await services.{{entity.name|lower}}_service.count().catch(next);

    res.status(200).json({ count: count });
});

// Delete by id (request.params.id)
router.delete('/:id', async function (req, res, next) {
    let result = await services.{{entity.name|lower}}_service.delete(req.params.id).catch(next);

    res.status(200).json(result);
});

// Find by id (request.params.id)
router.get('/:id', async function (req, res, next) {
    let {{entity.name|lower}} = await services.{{entity.name|lower}}_service.findById(req.params.id).catch(next);

    res.status(200).json({{entity.name|lower}});
});

// Create new
router.post('/', async function (req, res, next) {
    
    let result = await services.{{entity.name|lower}}_service.create(req.body).catch(next);

    res.status(201).json(result);
});

// Update existing
router.put('/', async function (req, res, next) {
    let result = await services.{{entity.name|lower}}_service.update(req.body).catch(next);

    res.status(200).json(result);
});
    
module.exports = router;
