// Autogenerated from {{model_filename}} file
// Created at {{timestamp|strftime}}

var express = require('express');
var path = require('path');
var logger = require('morgan');
var http = require('http');
const cors = require('cors');
var routes =  require('../routes');
var middlewares = require('../middlewares')

module.exports = () => {
    var app = express();

    app.use(cors({ origin: 'http://localhost:{{application.configObject.frontendPort}}' }));
    app.use(logger('dev'));
    app.use(express.json());
    app.use(express.urlencoded({ extended: false }));


    app.use('/static', express.static('public'));

    {% for entity in application.entities %}
    app.use('/{{entity.name|lowercase}}', routes.{{entity.name|lowercase}}_routes);
    {% endfor %}

    app.get('/', (req, res, next) => {
        res.sendfile('public/index.html');
    });
    
    app.use(middlewares.error_handler);


    return app;
};